import{_ as re,u as ie,r as v,l as y,o as ue,m as ce,c as m,a as n,b as de,t as l,d as r,n as p,h as _,p as D,e as S,f as ve,F as q,q as H,v as me,j as pe,T as fe,k as f}from"./index-DE__lAYy.js";const ge={class:"formatter"},he={class:"formatter-header"},je={class:"formatter-actions"},be=["disabled"],ye=["disabled"],_e=["disabled"],Se=["disabled"],ke={class:"formatter-content"},Ce={class:"panel-header"},we={class:"input-actions"},Ee=["title"],Je=["title"],Oe=["title"],Te={class:"editor-container with-line-numbers"},xe={class:"line-numbers"},Le=["placeholder"],De={key:0,class:"validation-message"},Ne=["title"],$e={key:1,class:"json-stats"},Re={class:"output-panel"},Me={class:"panel-header"},Ve={class:"output-actions"},Fe=["title","disabled"],Ie=["title","disabled"],ze={class:"editor-container with-line-numbers"},Ue={class:"line-numbers"},qe=["innerHTML"],He={key:0,class:"output-stats"},Be={key:0,class:"toast-container"},Ae={__name:"JsonFormatter",setup(Ke){const{t}=ie(),o=v(""),u=v(""),h=v(""),k=v(!1),C=v(!1),w=v(!1),j=v(!1),d=v(null),N=v(null),O=v(null),g=v({show:!1,message:"",type:"success",icon:"mdi-check-circle"});let T=null;const $=y(()=>o.value?o.value.split(`
`):[]),R=y(()=>u.value?u.value.split(`
`):[]),E=y(()=>o.value?{charCount:o.value.length,lineCount:$.value.length,maxDepth:P(o.value)}:null),J=y(()=>{if(!u.value)return null;const e=o.value.length,s=u.value.length,a=e>0?Math.round((1-s/e)*100):0;return{charCount:u.value.length,lineCount:R.value.length,compressionRatio:a}}),B=y(()=>u.value?G(u.value):""),A=(e,s)=>(...a)=>{clearTimeout(T),T=setTimeout(()=>e.apply(this,a),s)},i=(e,s="success")=>{g.value.message=e,g.value.type=s,g.value.icon=s==="success"?"mdi-check-circle":"mdi-alert-circle",g.value.show=!0,setTimeout(()=>{g.value.show=!1},3e3)},b=e=>{try{return e.trim()?(JSON.parse(e),h.value=t("json.validation.valid"),k.value=!0,j.value=!1,d.value=null,!0):(h.value="",k.value=!1,j.value=!1,d.value=null,!1)}catch(s){return h.value=`${t("json.validation.invalid")}: ${s.message}`,k.value=!1,j.value=!0,d.value=K(e,s.message),!1}},K=(e,s)=>{try{const a=e.split(`
`);for(let c=0;c<a.length;c++)try{JSON.parse(a.slice(0,c+1).join(`
`))}catch{return c+1}}catch{}return null},P=e=>{try{const s=JSON.parse(e);return M(s)}catch{return 0}},M=(e,s=0)=>{if(e===null||typeof e!="object")return s;let a=s;for(const c in e)e.hasOwnProperty(c)&&(a=Math.max(a,M(e[c],s+1)));return a},G=e=>{let s=e.replace(/("[^"]+?")(?=\s*:)/g,'<span class="json-key">$1</span>');return s=s.replace(/(:\s*)(".*?"|-?\d+(?:\.\d+)?|true|false|null)/g,'$1<span class="json-value">$2</span>'),s},V=A(()=>{if(o.value.trim()){if(b(o.value))try{const s=JSON.parse(o.value);u.value=JSON.stringify(s,null,2)}catch{}}else h.value="",u.value="",j.value=!1,d.value=null},300),Q=e=>{const s=e.target.files[0];s&&F(s),e.target.value=""},W=()=>{var e;(e=N.value)==null||e.click()},X=e=>{e.preventDefault(),w.value=!1;const s=e.dataTransfer.files;s.length>0&&F(s[0])},F=e=>{if(e.size>10*1024*1024){i(t("json.messages.fileSizeError"),"error");return}const s=new FileReader;s.onload=a=>{o.value=a.target.result,i(`${t("json.messages.fileLoaded")}: ${e.name}`)},s.onerror=()=>{i(t("json.messages.fileReadError"),"error")},s.readAsText(e)},Y=async()=>{if(!o.value.trim()){i(t("json.messages.inputRequired"),"error");return}try{if(b(o.value)){const e=JSON.parse(o.value);u.value=JSON.stringify(e,null,2),i(t("json.messages.formatSuccess"))}else i(t("json.messages.formatError"),"error")}catch(e){i(`${t("json.messages.formatError")}: ${e.message}`,"error")}},Z=async()=>{if(!o.value.trim()){i(t("json.messages.inputRequired"),"error");return}try{if(b(o.value)){const e=JSON.parse(o.value);u.value=JSON.stringify(e),i(t("json.messages.compressSuccess"))}else i(t("json.messages.formatError"),"error")}catch(e){i(`${t("json.messages.compressError")}: ${e.message}`,"error")}},ee=async()=>{if(!o.value.trim()){i(t("json.messages.inputRequired"),"error");return}try{b(o.value)?i(t("json.messages.validateSuccess")):i(t("json.messages.formatError"),"error")}catch(e){i(`${t("json.messages.validateError")}: ${e.message}`,"error")}},se=async()=>{if(!o.value.trim()){i(t("json.messages.inputRequired"),"error");return}try{if(!b(o.value)){i(t("json.messages.sortError"),"error");return}const e=JSON.parse(o.value),s=x(e);u.value=JSON.stringify(s,null,2),i(t("json.messages.sortSuccess"))}catch(e){i(`${t("json.messages.sortError")}: ${e.message}`,"error")}},x=e=>{if(e===null||typeof e!="object")return e;if(Array.isArray(e))return e.map(a=>x(a));const s={};return Object.keys(e).sort().forEach(a=>{s[a]=x(e[a])}),s},te=async()=>{if(!u.value){i(t("json.messages.noCopyContent"),"error");return}try{await navigator.clipboard.writeText(u.value),C.value=!0,i(t("json.messages.copySuccess")),setTimeout(()=>{C.value=!1},2e3)}catch{i(t("json.messages.copyError"),"error")}},ne=()=>{o.value="",h.value="",u.value="",j.value=!1,d.value=null,i(t("json.messages.clearSuccess"))},ae=async()=>{try{const e=await navigator.clipboard.readText();if(o.value=e,e.trim())if(b(e))try{const a=JSON.parse(e);u.value=JSON.stringify(a,null,2),i(t("json.messages.pasteSuccess"))}catch{i(t("json.messages.formatError"),"error")}else i(t("json.messages.formatError"),"error")}catch{i(t("json.messages.pasteError"),"error")}},oe=()=>{if(!u.value){i(t("json.messages.downloadError"),"error");return}const e=new Blob([u.value],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=`formatted_json_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),i(t("json.messages.downloadSuccess"))},le=()=>{if(d.value&&O.value){const e=O.value,s=o.value.split(`
`);let a=0;for(let L=0;L<d.value-1;L++)a+=s[L].length+1;e.setSelectionRange(a,a),e.focus();const U=(d.value-1)*20;e.scrollTop=Math.max(0,U-e.clientHeight/2)}},I=()=>{w.value=!0},z=()=>{w.value=!1};return ue(()=>{document.addEventListener("dragenter",I),document.addEventListener("dragleave",z)}),ce(()=>{document.removeEventListener("dragenter",I),document.removeEventListener("dragleave",z),clearTimeout(T)}),(e,s)=>(f(),m("div",ge,[n("div",he,[n("h1",null,l(r(t)("json.title")),1),n("p",null,l(r(t)("json.subtitle")),1)]),n("div",je,[n("button",{class:p(["main-btn",{disabled:!o.value.trim()}]),onClick:Y,disabled:!o.value.trim()},[s[5]||(s[5]=n("i",{class:"mdi mdi-code-json"},null,-1)),_(" "+l(r(t)("json.actions.format")),1)],10,be),n("button",{class:p(["main-btn",{disabled:!o.value.trim()}]),onClick:Z,disabled:!o.value.trim()},[s[6]||(s[6]=n("i",{class:"mdi mdi-arrow-collapse-horizontal"},null,-1)),_(" "+l(r(t)("json.actions.compress")),1)],10,ye),n("button",{class:p(["main-btn",{disabled:!o.value.trim()}]),onClick:ee,disabled:!o.value.trim()},[s[7]||(s[7]=n("i",{class:"mdi mdi-check-circle-outline"},null,-1)),_(" "+l(r(t)("json.actions.validate")),1)],10,_e),n("button",{class:p(["main-btn",{disabled:!o.value.trim()}]),onClick:se,disabled:!o.value.trim()},[s[8]||(s[8]=n("i",{class:"mdi mdi-sort-alphabetical-ascending"},null,-1)),_(" "+l(r(t)("json.actions.sort")),1)],10,Se)]),n("div",ke,[n("div",{class:"input-panel",onDrop:X,onDragover:s[2]||(s[2]=D(()=>{},["prevent"])),onDragenter:s[3]||(s[3]=D(()=>{},["prevent"])),onDragleave:s[4]||(s[4]=D(()=>{},["prevent"]))},[n("div",Ce,[n("h3",null,l(r(t)("json.labels.input")),1),n("div",we,[n("button",{class:"action-btn",onClick:ne,title:r(t)("json.actions.clear")},[s[9]||(s[9]=n("i",{class:"mdi mdi-delete-outline"},null,-1)),n("span",null,l(r(t)("json.actions.clear")),1)],8,Ee),n("button",{class:"action-btn",onClick:ae,title:r(t)("json.actions.paste")},[s[10]||(s[10]=n("i",{class:"mdi mdi-clipboard-text-outline"},null,-1)),n("span",null,l(r(t)("json.actions.paste")),1)],8,Je),n("button",{class:"action-btn",onClick:W,title:r(t)("json.actions.file")},[s[11]||(s[11]=n("i",{class:"mdi mdi-file-upload-outline"},null,-1)),n("span",null,l(r(t)("json.actions.file")),1)],8,Oe),n("input",{ref_key:"fileInput",ref:N,type:"file",onChange:Q,style:{display:"none"},accept:".json,.txt"},null,544)])]),n("div",Te,[n("div",xe,[(f(!0),m(q,null,H($.value,(a,c)=>(f(),m("div",{key:c,class:p(["line-number",{"error-line":d.value===c+1}])},l(c+1),3))),128))]),ve(n("textarea",{"onUpdate:modelValue":s[0]||(s[0]=a=>o.value=a),placeholder:r(t)("json.placeholders.input"),class:p(["json-input",{"drag-over":w.value,error:j.value}]),onInput:s[1]||(s[1]=(...a)=>r(V)&&r(V)(...a)),ref_key:"jsonTextarea",ref:O},null,42,Le),[[me,o.value]])]),h.value?(f(),m("div",De,[n("i",{class:p(["mdi",k.value?"mdi-check-circle text-success":"mdi-alert-circle text-error"])},null,2),n("span",null,l(h.value),1),d.value?(f(),m("button",{key:0,class:"error-location-btn",onClick:le,title:r(t)("json.errors.jumpToLine",{line:d.value})},[s[12]||(s[12]=n("i",{class:"mdi mdi-crosshairs-gps"},null,-1)),_(" "+l(r(t)("json.errors.jumpToLine",{line:d.value})),1)],8,Ne)):S("",!0)])):S("",!0),E.value?(f(),m("div",$e,[n("span",null,l(r(t)("json.stats.characters"))+": "+l(E.value.charCount),1),n("span",null,l(r(t)("json.stats.lines"))+": "+l(E.value.lineCount),1),n("span",null,l(r(t)("json.stats.depth"))+": "+l(E.value.maxDepth),1)])):S("",!0)],32),n("div",Re,[n("div",Me,[n("h3",null,l(r(t)("json.labels.output")),1),n("div",Ve,[n("button",{class:"action-btn",onClick:oe,title:r(t)("json.actions.download"),disabled:!u.value},[s[13]||(s[13]=n("i",{class:"mdi mdi-download-outline"},null,-1)),n("span",null,l(r(t)("json.actions.download")),1)],8,Fe),n("button",{class:"action-btn",onClick:te,title:r(t)("json.actions.copy"),disabled:!u.value},[n("i",{class:p(["mdi",C.value?"mdi-check":"mdi-content-copy"])},null,2),n("span",null,l(C.value?r(t)("json.actions.copied"):r(t)("json.actions.copy")),1)],8,Ie)])]),n("div",ze,[n("div",Ue,[(f(!0),m(q,null,H(R.value,(a,c)=>(f(),m("div",{key:c,class:"line-number"},l(c+1),1))),128))]),n("pre",{class:"json-output with-line-numbers",innerHTML:B.value},null,8,qe)]),J.value?(f(),m("div",He,[n("span",null,l(r(t)("json.stats.characters"))+": "+l(J.value.charCount),1),n("span",null,l(r(t)("json.stats.lines"))+": "+l(J.value.lineCount),1),n("span",null,l(r(t)("json.stats.compression"))+": "+l(J.value.compressionRatio)+"%",1)])):S("",!0)])]),de(fe,{name:"toast"},{default:pe(()=>[g.value.show?(f(),m("div",Be,[n("div",{class:p(["toast",g.value.type])},[n("i",{class:p(["mdi",g.value.icon])},null,2),n("span",null,l(g.value.message),1)],2)])):S("",!0)]),_:1})]))}},Ge=re(Ae,[["__scopeId","data-v-2fa91451"]]);export{Ge as default};
